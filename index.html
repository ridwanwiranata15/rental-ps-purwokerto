<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rental PlayStation - GameStation Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Reset dan variabel */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #5c6bc0;
            --primary-dark: #3f4ea0;
            --secondary: #ff5722;
            --light: #f5f5f5;
            --dark: #333;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --gray: #888;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-hover: 0 5px 15px rgba(0,0,0,0.15);
        }

        body {
            background-color: #f0f2f5;
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Header - Responsif */
        header {
            background-color: var(--primary);
            color: white;
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .logo i {
            font-size: 2rem;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }

        nav {
            width: 100%;
            order: 3;
            margin-top: 15px;
            display: none;
        }

        nav.active {
            display: block;
        }

        nav ul {
            display: flex;
            flex-direction: column;
            list-style: none;
            background-color: var(--primary-dark);
            border-radius: 8px;
            padding: 10px;
            gap: 5px;
        }

        nav li {
            width: 100%;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            padding: 12px 15px;
            border-radius: 4px;
            transition: background 0.3s;
            display: block;
            width: 100%;
        }

        nav a:hover, nav a.active {
            background-color: rgba(255,255,255,0.2);
        }

        .menu-toggle {
            display: block;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px 10px;
            margin-left: auto;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: auto;
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
        }

        .auth-buttons button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .btn-login {
            background-color: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-register {
            background-color: var(--secondary);
            color: white;
        }

        .btn-login:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .btn-register:hover {
            background-color: #e64a19;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-info span {
            font-weight: 600;
            white-space: nowrap;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            flex-shrink: 0;
        }

        /* Main content */
        main {
            min-height: calc(100vh - 200px);
            padding: 30px 0;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Dashboard */
        .hero {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            padding: 40px 20px;
            border-radius: 10px;
            margin-bottom: 40px;
            text-align: center;
        }

        .hero h2 {
            font-size: 2rem;
            margin-bottom: 15px;
            line-height: 1.3;
        }

        .hero p {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto 25px;
            line-height: 1.5;
        }

        .hero .btn-register {
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 6px;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .feature-card {
            background: white;
            padding: 25px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .feature-card i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .feature-card h3 {
            margin-bottom: 10px;
            color: var(--primary-dark);
            font-size: 1.3rem;
        }

        /* Active Booking Section */
        .active-booking {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border-left: 5px solid var(--primary);
        }

        .active-booking h2 {
            color: var(--primary-dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .active-booking h2 i {
            color: var(--primary);
        }

        .timer-container {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            margin-bottom: 25px;
            border: 2px solid var(--primary);
        }

        .timer-display {
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--primary-dark);
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .timer-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        .timer-info-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            flex: 1;
            min-width: 150px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.08);
        }

        .timer-info-item .label {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .timer-info-item .value {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary-dark);
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .timer-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 160px;
            justify-content: center;
        }

        .btn-pause {
            background-color: var(--warning);
            color: white;
        }

        .btn-pause:hover {
            background-color: #e68900;
        }

        .btn-resume {
            background-color: var(--success);
            color: white;
        }

        .btn-resume:hover {
            background-color: #3d8b40;
        }

        .btn-extend {
            background-color: var(--primary);
            color: white;
        }

        .btn-extend:hover {
            background-color: var(--primary-dark);
        }

        .btn-end {
            background-color: var(--danger);
            color: white;
        }

        .btn-end:hover {
            background-color: #d32f2f;
        }

        .booking-details {
            background: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .booking-details h3 {
            margin-bottom: 15px;
            color: var(--primary-dark);
        }

        .booking-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .detail-item {
            padding: 10px;
            background: white;
            border-radius: 6px;
        }

        .detail-item .label {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .detail-item .value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
        }

        /* Seat Selection */
        .seat-selection-container {
            margin: 25px 0;
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            display: block; /* Default ditampilkan */
        }

        .seat-selection-container.hidden {
            display: none; /* Akan disembunyikan saat main di rumah */
        }

        .seat-selection-container h3 {
            margin-bottom: 20px;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .seat-map {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .screen {
            background: linear-gradient(to right, #666, #999, #666);
            color: white;
            padding: 15px;
            text-align: center;
            width: 80%;
            border-radius: 5px;
            font-weight: bold;
            letter-spacing: 3px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .seat-row {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 10px;
        }

        .seat {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .seat.available {
            background-color: #e0e0e0;
            color: #333;
        }

        .seat.available:hover {
            background-color: #bdbdbd;
            transform: scale(1.05);
        }

        .seat.selected {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }

        .seat.occupied {
            background-color: var(--danger);
            color: white;
            cursor: not-allowed;
        }

        .seat.occupied:hover {
            background-color: var(--danger);
        }

        .seat-label {
            font-size: 0.9rem;
            margin-top: 5px;
            text-align: center;
        }

        .seat-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .available-color {
            background-color: #e0e0e0;
        }

        .selected-color {
            background-color: var(--success);
        }

        .occupied-color {
            background-color: var(--danger);
        }

        .seat-info {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }

        /* Menu Section - Separated Food and Drink */
        .menu-section {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .menu-category {
            margin-bottom: 25px;
        }

        .menu-category:last-child {
            margin-bottom: 0;
        }

        .menu-category h4 {
            margin-bottom: 15px;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            padding-bottom: 8px;
            border-bottom: 2px solid #eee;
        }

        .menu-category h4 i {
            color: var(--primary);
        }

        .menu-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
        }

        .menu-item {
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 6px;
            padding: 15px;
            border: 1px solid #eee;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .menu-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .item-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 1rem;
            color: var(--dark);
        }

        .item-description {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 8px;
            flex-grow: 1;
        }

        .item-price {
            color: var(--secondary);
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .item-quantity {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: auto;
        }

        .qty-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            font-weight: bold;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qty-btn:hover {
            background: #f0f0f0;
        }

        .qty-display {
            font-weight: 600;
            min-width: 30px;
            text-align: center;
        }

        /* Auth Forms */
        .auth-container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            padding: 30px 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .auth-container h2 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--primary);
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 18px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(92, 107, 192, 0.2);
        }

        .btn-submit {
            width: 100%;
            padding: 14px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-submit:hover {
            background-color: var(--primary-dark);
        }

        .auth-switch {
            text-align: center;
            margin-top: 20px;
            color: var(--gray);
        }

        .auth-switch a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }

        /* Booking Page */
        .page-title {
            margin-bottom: 25px;
            color: var(--primary-dark);
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
            font-size: 1.8rem;
        }

        .ps-selection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .ps-card {
            background: white;
            border-radius: 8px;
            padding: 20px 15px;
            text-align: center;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .ps-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .ps-card.selected {
            border-color: var(--primary);
            background-color: #f0f3ff;
        }

        .ps-icon {
            font-size: 2.2rem;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .ps-card h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .ps-card p {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .booking-form {
            background: white;
            padding: 25px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-top: 25px;
        }

        .booking-form h3 {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--primary-dark);
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-col {
            flex: 1;
            min-width: 100%;
        }

        .form-section {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .form-section h3 {
            margin-bottom: 15px;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
        }

        .radio-group, .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }

        .radio-label, .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 10px 15px;
            background: white;
            border-radius: 4px;
            border: 1px solid #ddd;
            transition: all 0.2s;
        }

        .radio-label:hover, .checkbox-label:hover {
            border-color: var(--primary);
        }

        .radio-input:checked + .radio-label,
        .checkbox-input:checked + .checkbox-label {
            background-color: #e8f0fe;
            border-color: var(--primary);
            color: var(--primary-dark);
        }

        .summary {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-top: 25px;
        }

        .summary h3 {
            margin-bottom: 15px;
            color: var(--primary-dark);
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #ddd;
        }

        .summary-total {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #ddd;
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-dark);
        }

        .btn-booking {
            width: 100%;
            padding: 16px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s;
        }

        .btn-booking:hover {
            background-color: #e64a19;
        }

        /* Billing Page - MASIH ADA TAPI DIAKSES LANGSUNG DARI DASHBOARD */
        .balance-card {
            background: white;
            padding: 25px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            text-align: center;
        }

        .balance-card h3 {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: var(--primary-dark);
        }

        .balance-amount {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }

        .balance-info {
            color: var(--gray);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .btn-topup {
            padding: 12px 30px;
            background-color: var(--success);
            color: white;
            border: none;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-topup:hover {
            background-color: #3d8b40;
        }

        .transaction-history {
            background: white;
            padding: 25px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            overflow-x: auto;
        }

        .transaction-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            min-width: 500px;
        }

        .transaction-table th, .transaction-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .transaction-table th {
            background-color: #f5f5f5;
            color: var(--primary-dark);
            font-weight: 600;
        }

        .status-paid {
            color: var(--success);
            font-weight: 600;
        }

        .status-pending {
            color: var(--warning);
            font-weight: 600;
        }

        .status-active {
            color: var(--primary);
            font-weight: 600;
        }

        /* Footer */
        footer {
            background-color: var(--primary-dark);
            color: white;
            padding: 40px 0 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-section h3 {
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 10px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .footer-section ul li i {
            margin-top: 3px;
        }

        .footer-section a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-section a:hover {
            color: white;
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #ddd;
            font-size: 0.9rem;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 25px 20px;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }

        .modal-header h3 {
            color: var(--primary-dark);
            font-size: 1.4rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--gray);
            line-height: 1;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Responsive Breakpoints */
        @media (min-width: 576px) {
            .hero h2 {
                font-size: 2.2rem;
            }
            
            .auth-container {
                padding: 30px;
            }
            
            .booking-form, .active-booking, .seat-selection-container {
                padding: 25px;
            }
            
            .balance-card, .transaction-history {
                padding: 25px;
            }
            
            .form-col {
                min-width: calc(50% - 10px);
            }
            
            .radio-group, .checkbox-group {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .menu-items {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .timer-display {
                font-size: 4rem;
            }
            
            .timer-info-item {
                min-width: 120px;
            }
            
            .seat {
                width: 50px;
                height: 50px;
            }
        }

        @media (min-width: 768px) {
            .logo {
                margin-bottom: 0;
            }
            
            nav {
                width: auto;
                order: 2;
                margin-top: 0;
                display: block !important;
                margin-left: 20px;
            }
            
            nav ul {
                flex-direction: row;
                background-color: transparent;
                padding: 0;
                gap: 10px;
            }
            
            nav li {
                width: auto;
            }
            
            nav a {
                padding: 8px 15px;
            }
            
            .menu-toggle {
                display: none;
            }
            
            .user-menu {
                margin-left: 0;
                order: 3;
            }
            
            .hero {
                padding: 50px 30px;
            }
            
            .hero h2 {
                font-size: 2.5rem;
            }
            
            .features {
                gap: 25px;
            }
            
            .ps-selection {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 20px;
            }
            
            .form-col {
                min-width: calc(50% - 10px);
            }
            
            .transaction-table {
                min-width: auto;
            }
            
            .timer-display {
                font-size: 4.5rem;
            }
            
            .timer-controls {
                flex-wrap: nowrap;
            }
            
            .timer-btn {
                min-width: 140px;
            }
            
            .seat-row {
                gap: 20px;
            }
        }

        @media (min-width: 992px) {
            .container {
                padding: 0 20px;
            }
            
            .hero {
                padding: 60px 40px;
            }
            
            .ps-selection {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
            
            .form-col {
                min-width: calc(33.333% - 14px);
            }
            
            .footer-content {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .timer-display {
                font-size: 5rem;
            }
            
            .menu-items {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
        }

        /* Utility Classes */
        .mb-10 { margin-bottom: 10px; }
        .mb-20 { margin-bottom: 20px; }
        .mb-30 { margin-bottom: 30px; }
        .text-center { text-align: center; }
        .d-block { display: block; }
        .d-none { display: none; }
        
        @media (max-width: 575px) {
            .hide-on-mobile {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <i class="fas fa-gamepad"></i>
                <h1>GameStation Pro</h1>
            </div>
            
            <button class="menu-toggle" id="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav id="main-nav">
                <ul>
                    <li><a href="#" class="nav-link active" data-page="dashboard">Dashboard</a></li>
                    <li><a href="#" class="nav-link" data-page="booking">Booking PS</a></li>
                    <li><a href="#" class="nav-link" data-page="history">Riwayat</a></li>
                    <!-- Billing dihapus dari navbar -->
                </ul>
            </nav>
            
            <div class="user-menu">
                <div id="auth-buttons" class="auth-buttons">
                    <button class="btn-login" id="btn-show-login">Login</button>
                    <button class="btn-register" id="btn-show-register">Register</button>
                </div>
                
                <div id="user-info" class="user-info" style="display: none;">
                    <div class="avatar" id="user-avatar">U</div>
                    <span id="username-display" class="hide-on-mobile">User</span>
                    <button id="btn-logout" class="btn-login">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Dashboard Page -->
        <section id="dashboard-page" class="page active">
            <!-- Active Booking Section (akan ditampilkan jika ada booking aktif DAN user sudah login) -->
            <div id="active-booking-section" class="active-booking" style="display: none;">
                <h2><i class="fas fa-clock"></i> Booking Aktif</h2>
                
                <div class="timer-container">
                    <div class="timer-display" id="timer-display">00:00:00</div>
                    <p id="timer-status">Waktu berjalan...</p>
                    
                    <div class="timer-info">
                        <div class="timer-info-item">
                            <div class="label">PlayStation</div>
                            <div class="value" id="timer-ps-type">PS5</div>
                        </div>
                        <div class="timer-info-item">
                            <div class="label">Durasi Total</div>
                            <div class="value" id="timer-total-duration">2 Jam</div>
                        </div>
                        <div class="timer-info-item">
                            <div class="label">Sisa Waktu</div>
                            <div class="value" id="timer-remaining">01:45:30</div>
                        </div>
                        <div class="timer-info-item">
                            <div class="label">Status</div>
                            <div class="value" id="timer-state">Berjalan</div>
                        </div>
                    </div>
                    
                    <div class="timer-controls">
                        <button class="timer-btn btn-pause" id="btn-pause-timer">
                            <i class="fas fa-pause"></i> Jeda Waktu
                        </button>
                        <button class="timer-btn btn-resume" id="btn-resume-timer" style="display: none;">
                            <i class="fas fa-play"></i> Lanjutkan
                        </button>
                        <button class="timer-btn btn-extend" id="btn-extend-timer">
                            <i class="fas fa-plus-circle"></i> Tambah Waktu
                        </button>
                        <button class="timer-btn btn-end" id="btn-end-timer">
                            <i class="fas fa-stop"></i> Akhiri Booking
                        </button>
                    </div>
                </div>
                
                <div class="booking-details">
                    <h3>Detail Booking</h3>
                    <div class="booking-details-grid" id="booking-details-grid">
                        <!-- Detail booking akan diisi oleh JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="hero">
                <h2>Selamat Datang di GameStation Pro</h2>
                <p>Tempat rental PlayStation terbaik dengan konsol terbaru, kenyamanan maksimal, dan harga terjangkau. Nikmati pengalaman gaming terbaik bersama teman-teman!</p>
                <button class="btn-register" id="hero-book-now">Booking Sekarang</button>
            </div>
            
            <h2 class="page-title">Fasilitas Unggulan Kami</h2>
            <div class="features">
                <div class="feature-card">
                    <i class="fas fa-tv"></i>
                    <h3>Konsol Terbaru</h3>
                    <p>PS5, PS4 Pro, dan PS4 Slim dengan kondisi terawat dan performa optimal.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-snowflake"></i>
                    <h3>Ruangan Ber-AC</h3>
                    <p>Ruang gaming nyaman dengan AC dan kursi ergonomis untuk sesi gaming lama.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-chair"></i>
                    <h3>Kursi Premium</h3>
                    <p>Kursi gaming ergonomis dengan pilihan posisi sesuai kenyamanan Anda.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-utensils"></i>
                    <h3>Menu Lengkap</h3>
                    <p>Berbagai pilihan makanan dan minuman untuk temani sesi gamingmu.</p>
                </div>
            </div>
            
            <!-- Billing & Saldo Section di Dashboard - Hanya ditampilkan jika user sudah login -->
            <div id="billing-section" class="balance-card" style="display: none;">
                <h3><i class="fas fa-wallet"></i> Saldo Anda</h3>
                <div class="balance-amount" id="user-balance">Rp 50.000</div>
                <p class="balance-info">Saldo dapat digunakan untuk pembayaran rental dan makanan/minuman</p>
                <button class="btn-topup" id="btn-topup">Top Up Saldo</button>
            </div>
            
            <!-- Pesan untuk user yang belum login -->
            <div id="login-prompt" class="balance-card">
                <h3><i class="fas fa-sign-in-alt"></i> Login untuk Akses Lengkap</h3>
                <p class="balance-info">Silakan login atau register untuk mulai booking PlayStation, melihat saldo, dan mengakses semua fitur kami.</p>
                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                    <button class="btn-login" id="prompt-login">Login</button>
                    <button class="btn-register" id="prompt-register">Register</button>
                </div>
            </div>
        </section>

        <!-- Booking Page -->
        <section id="booking-page" class="page">
            <div id="booking-login-prompt" style="display: none;">
                <div class="auth-container">
                    <h2><i class="fas fa-lock"></i> Login Required</h2>
                    <p>Anda harus login terlebih dahulu untuk melakukan booking.</p>
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 25px;">
                        <button class="btn-login" id="booking-page-login">Login</button>
                        <button class="btn-register" id="booking-page-register">Register</button>
                    </div>
                </div>
            </div>
            
            <div id="booking-content" style="display: none;">
                <h2 class="page-title">Booking PlayStation</h2>
                <p class="mb-20">Pilih konsol PlayStation yang ingin Anda sewa:</p>
                
                <div class="ps-selection">
                    <div class="ps-card" data-ps="ps01">
                        <div class="ps-icon"><i class="fab fa-playstation"></i></div>
                        <h3>PS5 Standard</h3>
                        <p>Latest console with 4K gaming</p>
                    </div>
                    <div class="ps-card" data-ps="ps02">
                        <div class="ps-icon"><i class="fab fa-playstation"></i></div>
                        <h3>PS5 Digital Edition</h3>
                        <p>Digital-only version</p>
                    </div>
                    <div class="ps-card" data-ps="ps03">
                        <div class="ps-icon"><i class="fab fa-playstation"></i></div>
                        <h3>PS4 Pro</h3>
                        <p>Enhanced 4K gaming</p>
                    </div>
                    <div class="ps-card" data-ps="ps04">
                        <div class="ps-icon"><i class="fab fa-playstation"></i></div>
                        <h3>PS4 Slim</h3>
                        <p>Compact and efficient</p>
                    </div>
                    <div class="ps-card" data-ps="ps05">
                        <div class="ps-icon"><i class="fab fa-playstation"></i></div>
                        <h3>PS4 Standard</h3>
                        <p>Classic PS4 experience</p>
                    </div>
                </div>
                
                <div id="booking-form" class="booking-form" style="display: none;">
                    <h3>Detail Booking untuk <span id="selected-ps-name">PS5 Standard</span></h3>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label>Durasi (minimal 2 jam)</label>
                                <select id="duration" class="form-control">
                                    <option value="2">2 Jam</option>
                                    <option value="3">3 Jam</option>
                                    <option value="4">4 Jam</option>
                                    <option value="5">5 Jam</option>
                                    <option value="6">6 Jam</option>
                                    <option value="8">8 Jam</option>
                                    <option value="10">10 Jam</option>
                                    <option value="12">12 Jam (1/2 hari)</option>
                                    <option value="24">24 Jam (1 hari)</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-col">
                            <div class="form-group">
                                <label>Jenis Ruangan</label>
                                <div class="radio-group">
                                    <input type="radio" id="ac-room" name="room-type" class="radio-input" value="ac" checked>
                                    <label for="ac-room" class="radio-label">
                                        <i class="fas fa-snowflake"></i> Ber-AC (Rp 6.000/jam)
                                    </label>
                                    
                                    <input type="radio" id="fan-room" name="room-type" class="radio-input" value="fan">
                                    <label for="fan-room" class="radio-label">
                                        <i class="fas fa-fan"></i> Kipas (Rp 5.000/jam)
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Seat Selection Section - Akan disembunyikan jika pilih main di rumah -->
                    <div class="seat-selection-container" id="seat-selection-container">
                        <h3><i class="fas fa-chair"></i> Pilih Kursi</h3>
                        <div class="seat-map">
                            <div class="screen">LAYAR</div>
                            <!-- Seat rows will be generated by JavaScript -->
                        </div>
                        <div class="seat-legend">
                            <div class="legend-item">
                                <div class="legend-color available-color"></div>
                                <span>Tersedia</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color selected-color"></div>
                                <span>Dipilih</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color occupied-color"></div>
                                <span>Tidak Tersedia</span>
                            </div>
                        </div>
                        <div class="seat-info">
                            <p>Kursi yang dipilih: <span id="selected-seats">Belum ada kursi yang dipilih</span></p>
                            <small>Biaya tambahan: Rp 2.000/kursi/jam</small>
                        </div>
                    </div>
                    
                    <!-- Separated Food and Drink Menu -->
                    <div class="menu-section">
                        <div class="menu-category">
                            <h4><i class="fas fa-utensils"></i> Makanan</h4>
                            <div class="menu-items" id="food-items">
                                <!-- Food items will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <div class="menu-category">
                            <h4><i class="fas fa-glass-cheers"></i> Minuman</h4>
                            <div class="menu-items" id="drink-items">
                                <!-- Drink items will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-map-marker-alt"></i> Lokasi Bermain</h3>
                        <div class="radio-group">
                            <input type="radio" id="play-rental" name="play-location" class="radio-input" value="rental" checked>
                            <label for="play-rental" class="radio-label">
                                <i class="fas fa-store"></i> Di Tempat Rental
                            </label>
                            
                            <input type="radio" id="play-home" name="play-location" class="radio-input" value="home">
                            <label for="play-home" class="radio-label">
                                <i class="fas fa-home"></i> Di Rumah Saya (Ada biaya transport)
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-credit-card"></i> Metode Pembayaran</h3>
                        <div class="radio-group">
                            <input type="radio" id="cash-payment" name="payment-method" class="radio-input" value="cash" checked>
                            <label for="cash-payment" class="radio-label">
                                <i class="fas fa-money-bill-wave"></i> Cash di Tempat
                            </label>
                            
                            <input type="radio" id="transfer-payment" name="payment-method" class="radio-input" value="transfer">
                            <label for="transfer-payment" class="radio-label">
                                <i class="fas fa-university"></i> Transfer Bank/Midtrans
                            </label>
                        </div>
                    </div>
                    
                    <div class="summary">
                        <h3>Ringkasan Pesanan</h3>
                        <div class="summary-item">
                            <span>Sewa PlayStation:</span>
                            <span id="summary-ps-price">Rp 0</span>
                        </div>
                        <div class="summary-item">
                            <span>Durasi:</span>
                            <span id="summary-duration">0 jam</span>
                        </div>
                        <div class="summary-item">
                            <span>Ruangan:</span>
                            <span id="summary-room">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Kursi:</span>
                            <span id="summary-seats">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Lokasi Bermain:</span>
                            <span id="summary-location">-</span>
                        </div>
                        <div class="summary-item">
                            <span>Makanan & Minuman:</span>
                            <span id="summary-food">Rp 0</span>
                        </div>
                        <div class="summary-item">
                            <span>Biaya Transport:</span>
                            <span id="summary-transport">Rp 0</span>
                        </div>
                        <div class="summary-total">
                            <span>Total Biaya:</span>
                            <span id="summary-total">Rp 0</span>
                        </div>
                    </div>
                    
                    <button class="btn-booking" id="btn-confirm-booking">Konfirmasi Booking</button>
                </div>
            </div>
        </section>

        <!-- History Page -->
        <section id="history-page" class="page">
            <div id="history-login-prompt" style="display: none;">
                <div class="auth-container">
                    <h2><i class="fas fa-lock"></i> Login Required</h2>
                    <p>Anda harus login terlebih dahulu untuk melihat riwayat booking.</p>
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 25px;">
                        <button class="btn-login" id="history-page-login">Login</button>
                        <button class="btn-register" id="history-page-register">Register</button>
                    </div>
                </div>
            </div>
            
            <div id="history-content" style="display: none;">
                <h2 class="page-title">Riwayat Booking</h2>
                
                <div class="transaction-history">
                    <div class="table-responsive">
                        <table class="transaction-table">
                            <thead>
                                <tr>
                                    <th>Tanggal</th>
                                    <th>PlayStation</th>
                                    <th>Kursi</th>
                                    <th>Durasi</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="booking-history-list">
                                <!-- Booking history will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container footer-content">
            <div class="footer-section">
                <h3>GameStation Pro</h3>
                <p>Tempat rental PlayStation terbaik dengan pengalaman gaming tak terlupakan. Konsol terbaru, ruangan nyaman, dan layanan terbaik untuk Anda.</p>
            </div>
            
            <div class="footer-section">
                <h3>Kontak Kami</h3>
                <ul>
                    <li><i class="fas fa-map-marker-alt"></i> Jl. Gaming No. 123, Jakarta</li>
                    <li><i class="fas fa-phone"></i> (021) 555-7890</li>
                    <li><i class="fas fa-envelope"></i> info@gamestation-pro.com</li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Jam Operasional</h3>
                <ul>
                    <li>Senin - Jumat: 10:00 - 22:00</li>
                    <li>Sabtu - Minggu: 09:00 - 23:00</li>
                    <li>Hari Libur: 09:00 - 23:00</li>
                </ul>
            </div>
        </div>
        
        <div class="container">
            <div class="copyright">
                &copy; 2023 GameStation Pro. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Login ke Akun Anda</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" class="form-control" id="login-username" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-control" id="login-password" required>
                </div>
                <button type="submit" class="btn-submit">Login</button>
            </form>
            <div class="auth-switch">
                Belum punya akun? <a href="#" id="switch-to-register">Register disini</a>
            </div>
        </div>
    </div>

    <div id="register-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Buat Akun Baru</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="register-form">
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" class="form-control" id="register-name" required>
                </div>
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" class="form-control" id="register-username" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" id="register-email" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-control" id="register-password" required>
                </div>
                <div class="form-group">
                    <label>Konfirmasi Password</label>
                    <input type="password" class="form-control" id="register-confirm-password" required>
                </div>
                <button type="submit" class="btn-submit">Daftar Sekarang</button>
            </form>
            <div class="auth-switch">
                Sudah punya akun? <a href="#" id="switch-to-login">Login disini</a>
            </div>
        </div>
    </div>

    <div id="topup-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Top Up Saldo</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label>Jumlah Top Up</label>
                <select id="topup-amount" class="form-control">
                    <option value="50000">Rp 50.000</option>
                    <option value="100000">Rp 100.000</option>
                    <option value="200000">Rp 200.000</option>
                    <option value="500000">Rp 500.000</option>
                    <option value="custom">Custom Amount</option>
                </select>
            </div>
            <div class="form-group" id="custom-amount-container" style="display: none;">
                <label>Jumlah Custom</label>
                <input type="number" class="form-control" id="custom-amount" min="10000" max="1000000" placeholder="Masukkan jumlah">
            </div>
            <div class="form-group">
                <label>Metode Pembayaran</label>
                <div class="radio-group">
                    <input type="radio" id="topup-midtrans" name="topup-method" class="radio-input" value="midtrans" checked>
                    <label for="topup-midtrans" class="radio-label">
                        <i class="fas fa-credit-card"></i> Midtrans (CC/Transfer)
                    </label>
                    
                    <input type="radio" id="topup-cash" name="topup-method" class="radio-input" value="cash">
                    <label for="topup-cash" class="radio-label">
                        <i class="fas fa-money-bill-wave"></i> Cash di Tempat
                    </label>
                </div>
            </div>
            <button class="btn-submit" id="btn-process-topup">Proses Top Up</button>
        </div>
    </div>

    <div id="booking-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Konfirmasi Booking</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="booking-confirmation-details">
                <!-- Booking details will be shown here -->
            </div>
            <button class="btn-booking" id="btn-final-confirm">Konfirmasi & Bayar</button>
        </div>
    </div>

    <div id="extend-time-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tambah Waktu Booking</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label>Tambahan Durasi</label>
                <select id="extend-duration" class="form-control">
                    <option value="1">1 Jam</option>
                    <option value="2">2 Jam</option>
                    <option value="3">3 Jam</option>
                    <option value="4">4 Jam</option>
                    <option value="5">5 Jam</option>
                    <option value="6">6 Jam</option>
                </select>
            </div>
            <div class="form-group">
                <label>Biaya Tambahan</label>
                <div class="form-control" id="extend-cost" style="background-color: #f9f9f9; font-weight: bold; color: var(--primary);">
                    Rp 0
                </div>
            </div>
            <button class="btn-booking" id="btn-confirm-extend">Tambah Waktu</button>
        </div>
    </div>

    <script>
        // Data aplikasi
        let currentUser = null;
        let selectedPS = null;
        let selectedSeats = [];
        let foodItems = [];
        let drinkItems = [];
        let userBalance = 50000;
        let transactions = [];
        let bookingHistory = [];
        
        // Timer variables dengan sistem yang lebih baik
        let activeBooking = null;
        let timerInterval = null;
        let isTimerPaused = false;
        let serverTimeOffset = 0; // Offset waktu server vs client

        // Inisialisasi data
        function initData() {
            // Data makanan
            foodItems = [
                { id: 1, name: "Nasi Goreng Special", description: "Nasi goreng dengan ayam, udang, dan sayuran", price: 25000, quantity: 0, category: "food" },
                { id: 2, name: "Mie Goreng Jawa", description: "Mie goreng khas Jawa dengan bumbu rempah", price: 20000, quantity: 0, category: "food" },
                { id: 3, name: "Kentang Goreng Keju", description: "Kentang goreng dengan taburan keju", price: 18000, quantity: 0, category: "food" },
                { id: 4, name: "Chicken Wings", description: "Sayap ayam goreng dengan saus pilihan", price: 22000, quantity: 0, category: "food" },
                { id: 5, name: "Sosis Bakar", description: "Sosis sapi bakar dengan saus barbeque", price: 15000, quantity: 0, category: "food" },
                { id: 6, name: "Pisang Goreng", description: "Pisang goreng dengan taburan keju dan coklat", price: 12000, quantity: 0, category: "food" }
            ];

            // Data minuman
            drinkItems = [
                { id: 101, name: "Es Teh Manis", description: "Teh manis dingin dengan lemon", price: 8000, quantity: 0, category: "drink" },
                { id: 102, name: "Jus Jeruk", description: "Jus jeruk segar tanpa gula", price: 12000, quantity: 0, category: "drink" },
                { id: 103, name: "Jus Alpukat", description: "Jus alpukat dengan susu kental manis", price: 15000, quantity: 0, category: "drink" },
                { id: 104, name: "Coca-Cola", description: "Minuman bersoda rasa cola", price: 10000, quantity: 0, category: "drink" },
                { id: 105, name: "Kopi Susu", description: "Kopi dengan susu dan gula", price: 12000, quantity: 0, category: "drink" },
                { id: 106, name: "Milkshake Coklat", description: "Milkshake coklat dengan whipped cream", price: 18000, quantity: 0, category: "drink" },
                { id: 107, name: "Air Mineral", description: "Air mineral botol 600ml", price: 5000, quantity: 0, category: "drink" },
                { id: 108, name: "Es Cincau", description: "Minuman cincau dengan sirup gula merah", price: 10000, quantity: 0, category: "drink" }
            ];

            // Data transaksi contoh
            transactions = [
                { date: "2023-10-15", description: "Top Up Saldo", amount: 100000, status: "paid" },
                { date: "2023-10-10", description: "Rental PS5 (3 jam)", amount: -45000, status: "paid" },
                { date: "2023-10-05", description: "Makanan & Minuman", amount: -25000, status: "paid" }
            ];

            // Data riwayat booking contoh
            bookingHistory = [
                { date: "2023-10-10", ps: "PS5 Standard", seat: "A3", duration: "3 jam", total: 45000, status: "completed" },
                { date: "2023-10-08", ps: "PS4 Pro", seat: "B2", duration: "2 jam", total: 30000, status: "completed" },
                { date: "2023-10-01", ps: "PS5 Digital", seat: "C4", duration: "5 jam", total: 70000, status: "completed" }
            ];

            // Generate seat map
            generateSeatMap();

            // Render menu
            renderMenuItems();

            // Cek apakah ada booking aktif di localStorage hanya jika user sudah login
            // Tapi booking aktif hanya akan ditampilkan setelah login
            // Sekarang kita hanya load data, tapi tidak start timer sampai user login

            // Simulasi sync waktu dengan server
            syncServerTime();
            
            // Setup event listener untuk lokasi bermain
            setupLocationChangeListener();
            
            // Update UI berdasarkan status login
            updateUIForLoginStatus();
        }

        // Update UI berdasarkan status login
        function updateUIForLoginStatus() {
            if (currentUser) {
                // User sudah login
                document.getElementById('login-prompt').style.display = 'none';
                document.getElementById('billing-section').style.display = 'block';
                document.getElementById('booking-login-prompt').style.display = 'none';
                document.getElementById('booking-content').style.display = 'block';
                document.getElementById('history-login-prompt').style.display = 'none';
                document.getElementById('history-content').style.display = 'block';
                
                // Cek booking aktif hanya setelah login
                checkActiveBookingAfterLogin();
            } else {
                // User belum login
                document.getElementById('login-prompt').style.display = 'block';
                document.getElementById('billing-section').style.display = 'none';
                document.getElementById('active-booking-section').style.display = 'none';
                document.getElementById('booking-login-prompt').style.display = 'block';
                document.getElementById('booking-content').style.display = 'none';
                document.getElementById('history-login-prompt').style.display = 'block';
                document.getElementById('history-content').style.display = 'none';
                
                // Hentikan timer jika ada
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
            }
        }

        // Cek booking aktif setelah login
        function checkActiveBookingAfterLogin() {
            if (!currentUser) return;
            
            const savedBooking = localStorage.getItem('activeBooking');
            if (savedBooking) {
                try {
                    activeBooking = JSON.parse(savedBooking);
                    
                    // Pastikan booking ini milik user yang login
                    // Di aplikasi nyata, ini akan dicek dengan user ID
                    // Untuk simulasi, kita asumsikan booking di localStorage adalah milik user yang login
                    
                    // Hitung server time offset (simulasi)
                    serverTimeOffset = 0;
                    
                    // Start timer untuk booking aktif
                    startActiveBookingTimer();
                } catch (e) {
                    console.error('Error parsing active booking:', e);
                    activeBooking = null;
                    localStorage.removeItem('activeBooking');
                }
            }
        }

        // Generate seat map
        function generateSeatMap() {
            const seatMap = document.querySelector('.seat-map');
            
            // Kosongkan seat map
            seatMap.innerHTML = '<div class="screen">LAYAR</div>';
            
            // Buat 4 baris kursi (A-D)
            const rows = ['A', 'B', 'C', 'D'];
            const seatsPerRow = 6;
            
            // Data kursi yang sudah dipesan (simulasi)
            const occupiedSeats = ['A1', 'B3', 'C5', 'D2'];
            
            rows.forEach(row => {
                const seatRow = document.createElement('div');
                seatRow.className = 'seat-row';
                
                for (let i = 1; i <= seatsPerRow; i++) {
                    const seatId = `${row}${i}`;
                    const seat = document.createElement('div');
                    seat.className = 'seat';
                    seat.textContent = seatId;
                    seat.dataset.seatId = seatId;
                    
                    // Cek apakah kursi sudah dipesan
                    if (occupiedSeats.includes(seatId)) {
                        seat.classList.add('occupied');
                    } else {
                        seat.classList.add('available');
                        seat.addEventListener('click', toggleSeatSelection);
                    }
                    
                    seatRow.appendChild(seat);
                }
                
                seatMap.appendChild(seatRow);
            });
        }

        // Setup event listener untuk perubahan lokasi bermain
        function setupLocationChangeListener() {
            const locationRadios = document.querySelectorAll('input[name="play-location"]');
            
            locationRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const seatSelectionContainer = document.getElementById('seat-selection-container');
                    
                    if (this.value === 'home') {
                        // Jika pilih main di rumah, sembunyikan pilih kursi
                        seatSelectionContainer.classList.add('hidden');
                        selectedSeats = []; // Reset kursi yang dipilih
                        updateSelectedSeatsDisplay();
                    } else {
                        // Jika pilih main di rental, tampilkan pilih kursi
                        seatSelectionContainer.classList.remove('hidden');
                    }
                    
                    updateSummary();
                });
            });
        }

        // Toggle seat selection
        function toggleSeatSelection(e) {
            const seat = e.target;
            const seatId = seat.dataset.seatId;
            
            if (seat.classList.contains('selected')) {
                // Hapus dari selected seats
                seat.classList.remove('selected');
                seat.classList.add('available');
                selectedSeats = selectedSeats.filter(id => id !== seatId);
            } else {
                // Tambah ke selected seats (maksimal 2 kursi per booking)
                if (selectedSeats.length >= 2) {
                    alert('Maksimal 2 kursi per booking. Silakan hapus salah satu kursi terlebih dahulu.');
                    return;
                }
                
                seat.classList.remove('available');
                seat.classList.add('selected');
                selectedSeats.push(seatId);
            }
            
            // Update tampilan kursi yang dipilih
            updateSelectedSeatsDisplay();
            updateSummary();
        }

        // Update tampilan kursi yang dipilih
        function updateSelectedSeatsDisplay() {
            const selectedSeatsElement = document.getElementById('selected-seats');
            if (selectedSeats.length > 0) {
                selectedSeatsElement.textContent = selectedSeats.join(', ');
                selectedSeatsElement.style.fontWeight = 'bold';
                selectedSeatsElement.style.color = 'var(--success)';
            } else {
                selectedSeatsElement.textContent = 'Belum ada kursi yang dipilih';
                selectedSeatsElement.style.fontWeight = 'normal';
                selectedSeatsElement.style.color = 'inherit';
            }
        }

        // Render menu items (separated food and drink)
        function renderMenuItems() {
            const foodContainer = document.getElementById('food-items');
            const drinkContainer = document.getElementById('drink-items');
            
            foodContainer.innerHTML = '';
            drinkContainer.innerHTML = '';
            
            // Render makanan
            foodItems.forEach(item => {
                const menuItem = createMenuItem(item);
                foodContainer.appendChild(menuItem);
            });
            
            // Render minuman
            drinkItems.forEach(item => {
                const menuItem = createMenuItem(item);
                drinkContainer.appendChild(menuItem);
            });
            
            // Add event listeners for quantity buttons
            setupQuantityButtons();
        }

        // Create menu item element
        function createMenuItem(item) {
            const menuItem = document.createElement('div');
            menuItem.className = 'menu-item';
            menuItem.innerHTML = `
                <div class="item-name">${item.name}</div>
                <div class="item-description">${item.description}</div>
                <div class="item-price">Rp ${item.price.toLocaleString()}</div>
                <div class="item-quantity">
                    <button class="qty-btn minus" data-id="${item.id}" data-category="${item.category}" aria-label="Kurangi jumlah">
                        <i class="fas fa-minus"></i>
                    </button>
                    <span class="qty-display" id="qty-${item.id}">${item.quantity}</span>
                    <button class="qty-btn plus" data-id="${item.id}" data-category="${item.category}" aria-label="Tambah jumlah">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            `;
            return menuItem;
        }

        // Setup quantity buttons
        function setupQuantityButtons() {
            document.querySelectorAll('.qty-btn.plus').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const category = this.getAttribute('data-category');
                    
                    let item;
                    if (category === 'food') {
                        item = foodItems.find(f => f.id === id);
                    } else {
                        item = drinkItems.find(d => d.id === id);
                    }
                    
                    if (item) {
                        item.quantity++;
                        document.getElementById(`qty-${id}`).textContent = item.quantity;
                        updateSummary();
                    }
                });
            });
            
            document.querySelectorAll('.qty-btn.minus').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const category = this.getAttribute('data-category');
                    
                    let item;
                    if (category === 'food') {
                        item = foodItems.find(f => f.id === id);
                    } else {
                        item = drinkItems.find(d => d.id === id);
                    }
                    
                    if (item && item.quantity > 0) {
                        item.quantity--;
                        document.getElementById(`qty-${id}`).textContent = item.quantity;
                        updateSummary();
                    }
                });
            });
        }

        // Render riwayat booking
        function renderBookingHistory() {
            const bookingList = document.getElementById('booking-history-list');
            bookingList.innerHTML = '';
            
            bookingHistory.forEach(booking => {
                const row = document.createElement('tr');
                const statusClass = booking.status === 'completed' ? 'status-paid' : 'status-pending';
                
                row.innerHTML = `
                    <td>${booking.date}</td>
                    <td>${booking.ps}</td>
                    <td>${booking.seat}</td>
                    <td>${booking.duration}</td>
                    <td>Rp ${booking.total.toLocaleString()}</td>
                    <td class="${statusClass}">${booking.status === 'completed' ? 'Selesai' : 'Pending'}</td>
                `;
                bookingList.appendChild(row);
            });
        }

        // Update ringkasan pesanan
        function updateSummary() {
            if (!selectedPS) return;
            
            const duration = parseInt(document.getElementById('duration').value);
            const roomType = document.querySelector('input[name="room-type"]:checked').value;
            const location = document.querySelector('input[name="play-location"]:checked').value;
            
            // Hitung harga PS berdasarkan jenis
            let psPricePerHour = 0;
            switch(selectedPS) {
                case 'ps01': psPricePerHour = 10000; break;
                case 'ps02': psPricePerHour = 9000; break;
                case 'ps03': psPricePerHour = 8000; break;
                case 'ps04': psPricePerHour = 7000; break;
                case 'ps05': psPricePerHour = 6000; break;
            }
            
            // Hitung harga ruangan per jam
            const roomPricePerHour = roomType === 'ac' ? 6000 : 5000;
            
            // Hitung biaya kursi (Rp 2.000 per kursi per jam) - HANYA jika main di rental
            let seatCostPerHour = 0;
            if (location === 'rental') {
                seatCostPerHour = selectedSeats.length * 2000;
            }
            
            // Hitung total harga per jam
            const pricePerHour = psPricePerHour + roomPricePerHour + seatCostPerHour;
            
            // Hitung total harga berdasarkan durasi
            let totalPS = pricePerHour * duration;
            
            // Tambah biaya transport jika bermain di rumah
            let transportCost = 0;
            if (location === 'home') {
                transportCost = 20000; // Biaya transport
                totalPS += transportCost;
            }
            
            // Hitung total makanan
            let totalFood = 0;
            foodItems.forEach(item => {
                totalFood += item.price * item.quantity;
            });
            
            // Hitung total minuman
            let totalDrink = 0;
            drinkItems.forEach(item => {
                totalDrink += item.price * item.quantity;
            });
            
            const totalMenu = totalFood + totalDrink;
            
            // Update ringkasan
            document.getElementById('summary-ps-price').textContent = `Rp ${totalPS.toLocaleString()}`;
            document.getElementById('summary-duration').textContent = `${duration} jam`;
            document.getElementById('summary-room').textContent = roomType === 'ac' ? 'Ber-AC' : 'Kipas Angin';
            
            // Tampilkan kursi hanya jika main di rental
            if (location === 'rental') {
                document.getElementById('summary-seats').textContent = selectedSeats.length > 0 ? selectedSeats.join(', ') : '-';
            } else {
                document.getElementById('summary-seats').textContent = 'Tidak berlaku';
            }
            
            document.getElementById('summary-location').textContent = location === 'rental' ? 'Di Rental' : 'Di Rumah';
            document.getElementById('summary-food').textContent = `Rp ${totalMenu.toLocaleString()}`;
            document.getElementById('summary-transport').textContent = `Rp ${transportCost.toLocaleString()}`;
            
            const total = totalPS + totalMenu;
            document.getElementById('summary-total').textContent = `Rp ${total.toLocaleString()}`;
        }

        // Sync waktu dengan server (simulasi)
        function syncServerTime() {
            // Dalam aplikasi nyata, ini akan memanggil API server untuk mendapatkan waktu server
            // Simulasi: server waktu adalah 0 detik offset dari client
            serverTimeOffset = 0;
            
            // Simpan waktu sync ke localStorage untuk konsistensi antar device
            localStorage.setItem('lastServerSync', Date.now());
        }

        // Get current server time (simulasi)
        function getServerTime() {
            // Dalam aplikasi nyata, ini akan menggunakan waktu server
            // Untuk simulasi, kita gunakan waktu client ditambah offset
            return Date.now() + serverTimeOffset;
        }

        // Timer functions dengan sistem yang lebih baik
        function startActiveBookingTimer() {
            if (!activeBooking || !currentUser) return; // Pastikan user sudah login
            
            // Tampilkan section booking aktif
            document.getElementById('active-booking-section').style.display = 'block';
            
            // Update tampilan timer
            updateTimerDisplay();
            
            // Update detail booking
            updateBookingDetails();
            
            // Start timer interval
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                if (!isTimerPaused) {
                    updateTimerDisplay();
                    
                    // Simpan status booking ke localStorage dengan waktu server
                    localStorage.setItem('activeBooking', JSON.stringify(activeBooking));
                    
                    // Cek jika waktu sudah habis
                    if (calculateRemainingTime() <= 0) {
                        clearInterval(timerInterval);
                        endActiveBooking();
                    }
                }
            }, 1000);
        }
        
        // Hitung sisa waktu dengan sistem waktu yang konsisten
        function calculateRemainingTime() {
            if (!activeBooking) return 0;
            
            const now = getServerTime();
            const startTime = new Date(activeBooking.startTime).getTime();
            const elapsedTime = now - startTime;
            const totalTime = activeBooking.duration * 3600 * 1000; // Konversi jam ke milidetik
            
            // Hitung waktu yang sudah terpakai (termasuk waktu pause)
            let usedTime = elapsedTime;
            if (activeBooking.pauseIntervals) {
                activeBooking.pauseIntervals.forEach(interval => {
                    usedTime -= (interval.end - interval.start);
                });
            }
            
            return Math.max(0, totalTime - usedTime);
        }
        
        function updateTimerDisplay() {
            if (!activeBooking) return;
            
            const remainingTime = calculateRemainingTime();
            const hours = Math.floor(remainingTime / 3600000);
            const minutes = Math.floor((remainingTime % 3600000) / 60000);
            const seconds = Math.floor((remainingTime % 60000) / 1000);
            
            // Format waktu
            const formattedTime = 
                String(hours).padStart(2, '0') + ':' + 
                String(minutes).padStart(2, '0') + ':' + 
                String(seconds).padStart(2, '0');
            
            // Update tampilan
            document.getElementById('timer-display').textContent = formattedTime;
            document.getElementById('timer-remaining').textContent = formattedTime;
            document.getElementById('timer-total-duration').textContent = `${activeBooking.duration} Jam`;
            document.getElementById('timer-ps-type').textContent = activeBooking.psName;
            
            // Update status timer
            if (isTimerPaused) {
                document.getElementById('timer-state').textContent = 'Dijeda';
                document.getElementById('timer-status').textContent = 'Waktu dihentikan sementara';
                document.getElementById('btn-pause-timer').style.display = 'none';
                document.getElementById('btn-resume-timer').style.display = 'flex';
            } else {
                document.getElementById('timer-state').textContent = 'Berjalan';
                document.getElementById('timer-status').textContent = 'Waktu berjalan...';
                document.getElementById('btn-pause-timer').style.display = 'flex';
                document.getElementById('btn-resume-timer').style.display = 'none';
            }
        }
        
        function updateBookingDetails() {
            if (!activeBooking) return;
            
            const detailsGrid = document.getElementById('booking-details-grid');
            detailsGrid.innerHTML = '';
            
            const details = [
                { label: 'PlayStation', value: activeBooking.psName },
                { label: 'Kursi', value: activeBooking.seats || '-' },
                { label: 'Ruangan', value: activeBooking.roomType === 'ac' ? 'Ber-AC' : 'Kipas Angin' },
                { label: 'Lokasi', value: activeBooking.location === 'rental' ? 'Di Rental' : 'Di Rumah' },
                { label: 'Makanan', value: activeBooking.foodTotal > 0 ? `Rp ${activeBooking.foodTotal.toLocaleString()}` : 'Tidak ada' },
                { label: 'Minuman', value: activeBooking.drinkTotal > 0 ? `Rp ${activeBooking.drinkTotal.toLocaleString()}` : 'Tidak ada' },
                { label: 'Mulai', value: new Date(activeBooking.startTime).toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' }) },
                { label: 'Total Biaya', value: `Rp ${activeBooking.totalCost.toLocaleString()}` }
            ];
            
            details.forEach(detail => {
                const detailItem = document.createElement('div');
                detailItem.className = 'detail-item';
                detailItem.innerHTML = `
                    <div class="label">${detail.label}</div>
                    <div class="value">${detail.value}</div>
                `;
                detailsGrid.appendChild(detailItem);
            });
        }
        
        function pauseTimer() {
            if (!isTimerPaused && activeBooking) {
                isTimerPaused = true;
                
                // Simpan waktu pause
                if (!activeBooking.pauseIntervals) {
                    activeBooking.pauseIntervals = [];
                }
                
                activeBooking.pauseIntervals.push({
                    start: getServerTime(),
                    end: null
                });
                
                localStorage.setItem('activeBooking', JSON.stringify(activeBooking));
                updateTimerDisplay();
            }
        }
        
        function resumeTimer() {
            if (isTimerPaused && activeBooking && activeBooking.pauseIntervals) {
                isTimerPaused = false;
                
                // Update waktu pause terakhir
                const lastPause = activeBooking.pauseIntervals[activeBooking.pauseIntervals.length - 1];
                if (lastPause && !lastPause.end) {
                    lastPause.end = getServerTime();
                }
                
                localStorage.setItem('activeBooking', JSON.stringify(activeBooking));
                updateTimerDisplay();
            }
        }
        
        function extendBookingTime(additionalHours) {
            if (!activeBooking) return;
            
            // Hitung biaya tambahan
            const pricePerHour = activeBooking.roomType === 'ac' ? 6000 : 5000;
            const psPricePerHour = activeBooking.psPricePerHour || 10000;
            const seatCostPerHour = (activeBooking.seats ? activeBooking.seats.split(',').length : 0) * 2000;
            const totalPricePerHour = pricePerHour + psPricePerHour + seatCostPerHour;
            const additionalCost = totalPricePerHour * additionalHours;
            
            // Update booking
            activeBooking.duration = parseInt(activeBooking.duration) + additionalHours;
            activeBooking.totalCost += additionalCost;
            
            // Simpan ke localStorage
            localStorage.setItem('activeBooking', JSON.stringify(activeBooking));
            
            // Update tampilan
            updateTimerDisplay();
            updateBookingDetails();
            
            // Tambahkan transaksi
            const today = new Date().toISOString().split('T')[0];
            transactions.unshift({
                date: today,
                description: `Perpanjangan waktu ${additionalHours} jam`,
                amount: -additionalCost,
                status: "paid"
            });
            
            // Update saldo di dashboard
            userBalance -= additionalCost;
            document.getElementById('user-balance').textContent = `Rp ${userBalance.toLocaleString()}`;
            
            alert(`Waktu berhasil ditambah ${additionalHours} jam. Biaya tambahan: Rp ${additionalCost.toLocaleString()}`);
        }
        
        function endActiveBooking() {
            clearInterval(timerInterval);
            
            // Tampilkan konfirmasi
            if (confirm('Apakah Anda yakin ingin mengakhiri booking sekarang?')) {
                // Tambahkan ke riwayat booking
                const today = new Date().toISOString().split('T')[0];
                bookingHistory.unshift({
                    date: today,
                    ps: activeBooking.psName,
                    seat: activeBooking.seats || '-',
                    duration: `${activeBooking.duration} jam`,
                    total: activeBooking.totalCost,
                    status: "completed"
                });
                
                renderBookingHistory();
                
                // Hapus booking aktif
                activeBooking = null;
                localStorage.removeItem('activeBooking');
                
                // Sembunyikan section booking aktif
                document.getElementById('active-booking-section').style.display = 'none';
                
                alert('Booking telah diakhiri. Terima kasih telah menggunakan layanan kami!');
            }
        }

        // Setup mobile menu toggle
        function setupMobileMenu() {
            const menuToggle = document.getElementById('menu-toggle');
            const mainNav = document.getElementById('main-nav');
            
            menuToggle.addEventListener('click', function() {
                mainNav.classList.toggle('active');
                const icon = this.querySelector('i');
                if (mainNav.classList.contains('active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // Close menu when clicking on a link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function() {
                    if (window.innerWidth < 768) {
                        mainNav.classList.remove('active');
                        menuToggle.querySelector('i').classList.remove('fa-times');
                        menuToggle.querySelector('i').classList.add('fa-bars');
                    }
                });
            });
            
            // Close menu when clicking outside
            document.addEventListener('click', function(event) {
                if (window.innerWidth < 768) {
                    const isClickInsideNav = mainNav.contains(event.target);
                    const isClickOnToggle = menuToggle.contains(event.target);
                    
                    if (!isClickInsideNav && !isClickOnToggle && mainNav.classList.contains('active')) {
                        mainNav.classList.remove('active');
                        menuToggle.querySelector('i').classList.remove('fa-times');
                        menuToggle.querySelector('i').classList.add('fa-bars');
                    }
                }
            });
        }

        // Navigasi antar halaman
        function setupNavigation() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Update nav active
                    document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show page
                    const pageId = this.getAttribute('data-page');
                    document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                    document.getElementById(`${pageId}-page`).classList.add('active');
                    
                    // Scroll ke atas halaman
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            });
            
            // Tombol booking dari hero
            document.getElementById('hero-book-now').addEventListener('click', function() {
                if (!currentUser) {
                    showModal('login-modal');
                    return;
                }
                
                // Navigate to booking page
                document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
                document.querySelector('[data-page="booking"]').classList.add('active');
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                document.getElementById('booking-page').classList.add('active');
                
                // Scroll ke atas halaman
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // Tombol login dari prompt di dashboard
            document.getElementById('prompt-login').addEventListener('click', () => showModal('login-modal'));
            document.getElementById('prompt-register').addEventListener('click', () => showModal('register-modal'));
            
            // Tombol login dari booking page
            document.getElementById('booking-page-login').addEventListener('click', () => showModal('login-modal'));
            document.getElementById('booking-page-register').addEventListener('click', () => showModal('register-modal'));
            
            // Tombol login dari history page
            document.getElementById('history-page-login').addEventListener('click', () => showModal('login-modal'));
            document.getElementById('history-page-register').addEventListener('click', () => showModal('register-modal'));
        }

        // Setup modals
        function setupModals() {
            // Show login modal
            document.getElementById('btn-show-login').addEventListener('click', () => showModal('login-modal'));
            
            // Show register modal
            document.getElementById('btn-show-register').addEventListener('click', () => showModal('register-modal'));
            
            // Switch between login and register
            document.getElementById('switch-to-register').addEventListener('click', (e) => {
                e.preventDefault();
                hideModal('login-modal');
                showModal('register-modal');
            });
            
            document.getElementById('switch-to-login').addEventListener('click', (e) => {
                e.preventDefault();
                hideModal('register-modal');
                showModal('login-modal');
            });
            
            // Close modals
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').classList.remove('active');
                });
            });
            
            // Close modal when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                    }
                });
            });
            
            // Login form
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;
                
                // Simulasi login
                if (username && password) {
                    currentUser = {
                        name: username,
                        username: username,
                        email: `${username}@example.com`,
                        id: 'user_' + Date.now() // ID unik untuk user
                    };
                    
                    updateUserDisplay();
                    hideModal('login-modal');
                    alert(`Login berhasil! Selamat datang ${username}`);
                    
                    // Update UI setelah login
                    updateUIForLoginStatus();
                } else {
                    alert('Silakan isi username dan password');
                }
            });
            
            // Register form
            document.getElementById('register-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('register-name').value;
                const username = document.getElementById('register-username').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const confirmPassword = document.getElementById('register-confirm-password').value;
                
                if (password !== confirmPassword) {
                    alert('Password dan konfirmasi password tidak cocok');
                    return;
                }
                
                // Simulasi registrasi
                currentUser = {
                    name: name,
                    username: username,
                    email: email,
                    id: 'user_' + Date.now() // ID unik untuk user
                };
                
                // Set saldo awal untuk user baru
                userBalance = 50000;
                document.getElementById('user-balance').textContent = `Rp ${userBalance.toLocaleString()}`;
                
                updateUserDisplay();
                hideModal('register-modal');
                alert(`Registrasi berhasil! Selamat datang ${name}. Anda mendapatkan saldo awal Rp 50.000.`);
                
                // Update UI setelah registrasi
                updateUIForLoginStatus();
            });
            
            // Logout
            document.getElementById('btn-logout').addEventListener('click', function() {
                // Hentikan timer jika ada
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
                
                currentUser = null;
                updateUserDisplay();
                alert('Anda telah logout');
                
                // Update UI setelah logout
                updateUIForLoginStatus();
                
                // Kembali ke dashboard
                document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
                document.querySelector('[data-page="dashboard"]').classList.add('active');
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                document.getElementById('dashboard-page').classList.add('active');
            });
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Hide modal
        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Update user display
        function updateUserDisplay() {
            const authButtons = document.getElementById('auth-buttons');
            const userInfo = document.getElementById('user-info');
            const userAvatar = document.getElementById('user-avatar');
            const usernameDisplay = document.getElementById('username-display');
            
            if (currentUser) {
                authButtons.style.display = 'none';
                userInfo.style.display = 'flex';
                userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
                usernameDisplay.textContent = currentUser.name;
            } else {
                authButtons.style.display = 'flex';
                userInfo.style.display = 'none';
            }
        }

        // Setup booking functionality
        function setupBooking() {
            // PS selection
            document.querySelectorAll('.ps-card').forEach(card => {
                card.addEventListener('click', function() {
                    // Remove selection from all cards
                    document.querySelectorAll('.ps-card').forEach(c => c.classList.remove('selected'));
                    
                    // Add selection to clicked card
                    this.classList.add('selected');
                    
                    // Set selected PS
                    selectedPS = this.getAttribute('data-ps');
                    
                    // Show booking form
                    document.getElementById('booking-form').style.display = 'block';
                    
                    // Update PS name
                    const psName = this.querySelector('h3').textContent;
                    document.getElementById('selected-ps-name').textContent = psName;
                    
                    // Update summary
                    updateSummary();
                    
                    // Scroll ke form booking
                    document.getElementById('booking-form').scrollIntoView({ behavior: 'smooth' });
                });
            });
            
            // Form changes
            document.getElementById('duration').addEventListener('change', updateSummary);
            document.querySelectorAll('input[name="room-type"]').forEach(radio => {
                radio.addEventListener('change', updateSummary);
            });
            
            // Top up modal
            document.getElementById('btn-topup').addEventListener('click', () => showModal('topup-modal'));
            
            // Custom amount selection
            document.getElementById('topup-amount').addEventListener('change', function() {
                const customContainer = document.getElementById('custom-amount-container');
                if (this.value === 'custom') {
                    customContainer.style.display = 'block';
                } else {
                    customContainer.style.display = 'none';
                }
            });
            
            // Process top up
            document.getElementById('btn-process-topup').addEventListener('click', function() {
                let amount = parseInt(document.getElementById('topup-amount').value);
                
                if (document.getElementById('topup-amount').value === 'custom') {
                    amount = parseInt(document.getElementById('custom-amount').value) || 0;
                }
                
                if (amount < 10000) {
                    alert('Minimum top up adalah Rp 10.000');
                    return;
                }
                
                // Update balance
                userBalance += amount;
                document.getElementById('user-balance').textContent = `Rp ${userBalance.toLocaleString()}`;
                
                // Add transaction
                const today = new Date().toISOString().split('T')[0];
                transactions.unshift({
                    date: today,
                    description: "Top Up Saldo",
                    amount: amount,
                    status: "paid"
                });
                
                hideModal('topup-modal');
                alert(`Top up berhasil! Saldo Anda sekarang Rp ${userBalance.toLocaleString()}`);
            });
            
            // Confirm booking
            document.getElementById('btn-confirm-booking').addEventListener('click', function() {
                if (!selectedPS) {
                    alert('Silakan pilih PlayStation terlebih dahulu');
                    return;
                }
                
                // Validasi kursi hanya jika main di rental
                const location = document.querySelector('input[name="play-location"]:checked').value;
                if (location === 'rental' && selectedSeats.length === 0) {
                    alert('Silakan pilih minimal 1 kursi');
                    return;
                }
                
                // Get all booking details
                const duration = parseInt(document.getElementById('duration').value);
                const roomType = document.querySelector('input[name="room-type"]:checked').value;
                const paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;
                const total = parseInt(document.getElementById('summary-total').textContent.replace('Rp ', '').replace(/\./g, ''));
                const psName = document.getElementById('selected-ps-name').textContent;
                
                // Prepare booking details for confirmation
                const roomName = roomType === 'ac' ? 'Ber-AC' : 'Kipas Angin';
                const locationName = location === 'rental' ? 'Di Rental' : 'Di Rumah';
                const paymentName = paymentMethod === 'cash' ? 'Cash' : 'Transfer Bank';
                
                // Hitung harga per jam untuk PS
                let psPricePerHour = 0;
                switch(selectedPS) {
                    case 'ps01': psPricePerHour = 10000; break;
                    case 'ps02': psPricePerHour = 9000; break;
                    case 'ps03': psPricePerHour = 8000; break;
                    case 'ps04': psPricePerHour = 7000; break;
                    case 'ps05': psPricePerHour = 6000; break;
                }
                
                // Hitung total makanan
                let totalFood = 0;
                let foodDetails = '';
                let hasFood = false;
                foodItems.forEach(item => {
                    if (item.quantity > 0) {
                        hasFood = true;
                        totalFood += item.price * item.quantity;
                        foodDetails += `<li>${item.name} (${item.quantity}x): Rp ${(item.price * item.quantity).toLocaleString()}</li>`;
                    }
                });
                
                // Hitung total minuman
                let totalDrink = 0;
                let drinkDetails = '';
                let hasDrink = false;
                drinkItems.forEach(item => {
                    if (item.quantity > 0) {
                        hasDrink = true;
                        totalDrink += item.price * item.quantity;
                        drinkDetails += `<li>${item.name} (${item.quantity}x): Rp ${(item.price * item.quantity).toLocaleString()}</li>`;
                    }
                });
                
                if (!hasFood && !hasDrink) {
                    foodDetails = '<li>Tidak ada makanan/minuman</li>';
                }
                
                // Show confirmation modal
                document.getElementById('booking-confirmation-details').innerHTML = `
                    <div class="form-section">
                        <p><strong>PlayStation:</strong> ${psName}</p>
                        ${location === 'rental' ? `<p><strong>Kursi:</strong> ${selectedSeats.join(', ')}</p>` : ''}
                        <p><strong>Durasi:</strong> ${duration} jam</p>
                        <p><strong>Ruangan:</strong> ${roomName}</p>
                        <p><strong>Lokasi Bermain:</strong> ${locationName}</p>
                        <p><strong>Makanan & Minuman:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 5px; margin-bottom: 15px;">
                            ${hasFood ? '<li><strong>Makanan:</strong></li>' + foodDetails : ''}
                            ${hasDrink ? '<li><strong>Minuman:</strong></li>' + drinkDetails : ''}
                            ${!hasFood && !hasDrink ? foodDetails : ''}
                        </ul>
                        <p><strong>Metode Pembayaran:</strong> ${paymentName}</p>
                        <p><strong>Total Biaya:</strong> <span style="font-weight: bold; color: var(--primary);">Rp ${total.toLocaleString()}</span></p>
                    </div>
                `;
                
                // Simpan data untuk final confirm
                document.getElementById('btn-final-confirm').dataset.bookingData = JSON.stringify({
                    psName: psName,
                    seats: location === 'rental' ? selectedSeats.join(', ') : '',
                    duration: duration,
                    roomType: roomType,
                    location: location,
                    paymentMethod: paymentMethod,
                    total: total,
                    psPricePerHour: psPricePerHour,
                    foodTotal: totalFood,
                    drinkTotal: totalDrink
                });
                
                showModal('booking-modal');
            });
            
            // Final confirm booking
            document.getElementById('btn-final-confirm').addEventListener('click', function() {
                const bookingData = JSON.parse(this.dataset.bookingData);
                const total = bookingData.total;
                const paymentMethod = bookingData.paymentMethod;
                
                // Check payment method - hanya untuk transfer bank perlu cek saldo
                if (paymentMethod === 'transfer') {
                    if (userBalance < total) {
                        alert('Saldo tidak cukup. Silakan top up atau gunakan metode pembayaran cash.');
                        return;
                    }
                    
                    // Deduct from balance
                    userBalance -= total;
                    document.getElementById('user-balance').textContent = `Rp ${userBalance.toLocaleString()}`;
                    
                    // Add transaction
                    const today = new Date().toISOString().split('T')[0];
                    transactions.unshift({
                        date: today,
                        description: "Rental PlayStation",
                        amount: -total,
                        status: "paid"
                    });
                }
                
                // Create active booking dengan sistem waktu yang konsisten
                activeBooking = {
                    psName: bookingData.psName,
                    seats: bookingData.seats,
                    duration: bookingData.duration,
                    roomType: bookingData.roomType,
                    location: bookingData.location,
                    totalCost: total,
                    psPricePerHour: bookingData.psPricePerHour,
                    foodTotal: bookingData.foodTotal,
                    drinkTotal: bookingData.drinkTotal,
                    startTime: new Date(getServerTime()).toISOString() // Gunakan waktu server
                };
                
                // Start the timer
                startActiveBookingTimer();
                
                hideModal('booking-modal');
                alert('Booking berhasil! Waktu mulai berjalan.');
                
                // Reset form
                document.querySelectorAll('.ps-card').forEach(c => c.classList.remove('selected'));
                document.getElementById('booking-form').style.display = 'none';
                selectedPS = null;
                selectedSeats = [];
                updateSelectedSeatsDisplay();
                
                // Reset food and drink quantities
                foodItems.forEach(item => item.quantity = 0);
                drinkItems.forEach(item => item.quantity = 0);
                renderMenuItems();
                
                // Navigate to dashboard
                document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
                document.querySelector('[data-page="dashboard"]').classList.add('active');
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                document.getElementById('dashboard-page').classList.add('active');
                
                // Tambahkan ke riwayat booking
                const today = new Date().toISOString().split('T')[0];
                bookingHistory.unshift({
                    date: today,
                    ps: bookingData.psName,
                    seat: bookingData.seats || '-',
                    duration: `${bookingData.duration} jam`,
                    total: total,
                    status: "active"
                });
                
                renderBookingHistory();
            });
            
            // Timer controls
            document.getElementById('btn-pause-timer').addEventListener('click', pauseTimer);
            document.getElementById('btn-resume-timer').addEventListener('click', resumeTimer);
            
            // Extend time button
            document.getElementById('btn-extend-timer').addEventListener('click', function() {
                if (!activeBooking) return;
                
                // Setup extend modal
                document.getElementById('extend-duration').value = '1';
                updateExtendCost();
                
                showModal('extend-time-modal');
            });
            
            // Update extend cost when duration changes
            document.getElementById('extend-duration').addEventListener('change', updateExtendCost);
            
            // Confirm extend time
            document.getElementById('btn-confirm-extend').addEventListener('click', function() {
                const additionalHours = parseInt(document.getElementById('extend-duration').value);
                extendBookingTime(additionalHours);
                hideModal('extend-time-modal');
            });
            
            // End booking button
            document.getElementById('btn-end-timer').addEventListener('click', endActiveBooking);
        }
        
        function updateExtendCost() {
            if (!activeBooking) return;
            
            const additionalHours = parseInt(document.getElementById('extend-duration').value);
            const pricePerHour = activeBooking.roomType === 'ac' ? 6000 : 5000;
            const psPricePerHour = activeBooking.psPricePerHour || 10000;
            const seatCostPerHour = (activeBooking.seats ? activeBooking.seats.split(',').length : 0) * 2000;
            const totalPricePerHour = pricePerHour + psPricePerHour + seatCostPerHour;
            const additionalCost = totalPricePerHour * additionalHours;
            
            document.getElementById('extend-cost').textContent = `Rp ${additionalCost.toLocaleString()}`;
        }

        // Handle window resize
        function handleResize() {
            const menuToggle = document.getElementById('menu-toggle');
            const mainNav = document.getElementById('main-nav');
            
            if (window.innerWidth >= 768) {
                // Pada layar besar, pastikan menu terlihat
                mainNav.classList.remove('active');
                menuToggle.querySelector('i').classList.remove('fa-times');
                menuToggle.querySelector('i').classList.add('fa-bars');
            }
        }

        // Initialize the application
        function init() {
            initData();
            setupMobileMenu();
            setupNavigation();
            setupModals();
            setupBooking();
            
            // Set initial user balance display
            document.getElementById('user-balance').textContent = `Rp ${userBalance.toLocaleString()}`;
            
            // Add resize listener
            window.addEventListener('resize', handleResize);
            
            // Initial resize check
            handleResize();
        }

        // Start the app when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>